<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>计算机网络-谢希任-网络层 | JeckFS</title><meta name="keywords" content="网络"><meta name="author" content="YFS"><meta name="copyright" content="YFS"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="1. 网际协议IP 与IP协议配套的三个协议：  地址解析协议ARP 网际控制报文协议ICMP（Internet Control Message Protocol） 网际组管理协议IGMP（Internet Group Management Protocol）    1.1 分类的IP地址 特殊的地址：  网络号为127，表示环回地址，用于本主机进程间的通信。 主机号全0，表示本网络的网络地址。">
<meta property="og:type" content="article">
<meta property="og:title" content="计算机网络-谢希任-网络层">
<meta property="og:url" content="http://jeckfs.gitee.io/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/index.html">
<meta property="og:site_name" content="JeckFS">
<meta property="og:description" content="1. 网际协议IP 与IP协议配套的三个协议：  地址解析协议ARP 网际控制报文协议ICMP（Internet Control Message Protocol） 网际组管理协议IGMP（Internet Group Management Protocol）    1.1 分类的IP地址 特殊的地址：  网络号为127，表示环回地址，用于本主机进程间的通信。 主机号全0，表示本网络的网络地址。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img1.baidu.com/it/u=2598981474,2305186611&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=500">
<meta property="article:published_time" content="2020-07-27T09:47:26.000Z">
<meta property="article:modified_time" content="2022-06-09T12:50:05.388Z">
<meta property="article:author" content="YFS">
<meta property="article:tag" content="网络">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img1.baidu.com/it/u=2598981474,2305186611&fm=253&fmt=auto&app=138&f=JPEG?w=800&h=500"><link rel="shortcut icon" href="/JeckFS/img/favicon.png"><link rel="canonical" href="http://jeckfs.gitee.io/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/JeckFS/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/JeckFS/',
  algolia: undefined,
  localSearch: {"path":"/JeckFS/search.xml","preload":false,"languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '计算机网络-谢希任-网络层',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-06-09 20:50:05'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/JeckFS/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/JeckFS/tags/"><div class="headline">标签</div><div class="length-num">62</div></a><a href="/JeckFS/categories/"><div class="headline">分类</div><div class="length-num">57</div></a></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://img1.baidu.com/it/u=2598981474,2305186611&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=800&amp;h=500')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/JeckFS/">JeckFS</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">计算机网络-谢希任-网络层</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-27T09:47:26.000Z" title="发表于 2020-07-27 17:47:26">2020-07-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-06-09T12:50:05.388Z" title="更新于 2022-06-09 20:50:05">2022-06-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/JeckFS/categories/%E7%BD%91%E7%BB%9C/">网络</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="计算机网络-谢希任-网络层"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="1-网际协议IP"><a href="#1-网际协议IP" class="headerlink" title="1. 网际协议IP"></a>1. 网际协议IP</h1><blockquote>
<p>与IP协议配套的三个协议：</p>
<ul>
<li>地址解析协议ARP</li>
<li>网际控制报文协议ICMP（Internet Control Message Protocol）</li>
<li>网际组管理协议IGMP（Internet Group Management Protocol）</li>
</ul>
</blockquote>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200328140201435.png" class="" title="This is image-20200328140201435.png image.">
<h2 id="1-1-分类的IP地址"><a href="#1-1-分类的IP地址" class="headerlink" title="1.1 分类的IP地址"></a>1.1 分类的IP地址</h2><img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200328140915851.png" class="" title="This is image-20200328140915851.png image.">
<p>特殊的地址：</p>
<ul>
<li>网络号为127，表示环回地址，用于本主机进程间的通信。</li>
<li>主机号全0，表示本网络的网络地址。</li>
<li>主机号全1，表示本网络的所有主机。</li>
<li>B类网络地址128.0.0.0是不指派的，B类最小的网络地址是128.1.0.0。</li>
<li>C类网络地址192.0.0.0也不指派，C类最小的网络地址是192.0.1.0</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200328142056246.png" class="" title="This is image-20200328142056246.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200328142251806.png" class="" title="This is image-20200328142251806.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200328142842893.png" class="" title="This is image-20200328142842893.png image.">
<p>​    两个路由器直接相连的接口，可以分配ip地址，也可以不分配ip地址。不分配的话$N_1,N_2,N_3$称为<strong>无编号网络</strong>或<strong>无名网络</strong>。</p>
<h2 id="1-2-IP地址和硬件地址"><a href="#1-2-IP地址和硬件地址" class="headerlink" title="1.2 IP地址和硬件地址"></a>1.2 IP地址和硬件地址</h2><img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329100336482.png" class="" title="This is image-20200329100336482.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329100445763.png" class="" title="This is image-20200329100445763.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329100512508.png" class="" title="This is image-20200329100512508.png image.">
<h2 id="1-3-地址解析协议ARP"><a href="#1-3-地址解析协议ARP" class="headerlink" title="1.3. 地址解析协议ARP"></a>1.3. 地址解析协议ARP</h2><p>​    作用是根据IP地址解析出MAC地址。</p>
<p>​    DHCP协议已经包含RARP的功能，即根据MAC地址找出IP地址。RARP已经被淘汰。</p>
<p>​    只能解析<strong>本局域网</strong>中的MAC地址。</p>
<p><strong>ARP协议要点：</strong></p>
<ul>
<li>每台主机都设有一个ARP高速缓存，里面保存本局域网上的各主机和路由器的IP地址到硬件地址的映射表。</li>
<li>当主机A向本局域网的主机B发送IP数据包时，先查看ARP高速缓存中是否有主机B的IP地址。若有，根据IP找到对应的MAC地址。</li>
<li>若查找不到主机B的ip，则主机A运行ARP协议<ul>
<li>ARP进程在本局域网中广播一个包含本机IP的ARP请求分组，如图4-11（a）。</li>
<li>本局域网所有主机上运行的ARP进程都收到此ARP请求分组。</li>
<li>主机B的IP与查询的IP一致，就收下这个ARP分组，并写入A主机IP与其MAC地址的映射，并向主机A发送写入本机IP地址的ARP响应分组。其他主机因为查询IP与自己不一致而忽略此ARP分组。</li>
<li>主机A收到B的ARP响应分组后，就在ARP高速缓存中写入主机B的IP与其MAC地址的映射。</li>
</ul>
</li>
<li>ARP映射表项都有一个生存时间，过期自动删除。</li>
<li>如果主机A与主机B不在一个局域网中， A主机解析出的是路由的MAC地址。</li>
</ul>
<h2 id="4-IP数据包的格式"><a href="#4-IP数据包的格式" class="headerlink" title="4. IP数据包的格式"></a>4. IP数据包的格式</h2><img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329102953193.png" class="" title="This is image-20200329102953193.png image.">
<ul>
<li><p>版本</p>
<p>指IP协议版本，IPv4或IPv6</p>
</li>
<li><p>首部长度</p>
<p>最大为15，单位是4字节，即数据包首部最大15*4=60字节。由于固定部分20字节，所以首部长度最小为5。IP数据包的首部必须是4的整数倍，不足的使用填充字段填充。</p>
</li>
<li><p>区分服务</p>
<p>一般情况不用。</p>
</li>
<li><p>总长度</p>
<p>首部+数据，单位为字节。最大2^16^-1=65535字节，实际中极少遇到。在数据链路层由于MTU的限制，会将大的IP数据包分片。分片后的数据包的总长度是该分片的首部+数据的长度。</p>
</li>
<li><p>标识</p>
<p>用于标识哪些分片同属一个IP数据包，同属一个IP数据包的分片拥有相同的标识。</p>
</li>
<li><p>标志</p>
<p>占3位，只有前两位有意义。</p>
<p>中间位DF(Don’t Fragment)。DF=1表示不能分片，DF=0表示可以分片。</p>
</li>
<li><p>片偏移</p>
<p>占13位，表示某片在分片前的原分组中数据字段的相对位置。片偏移以8字节为偏移单位，即每个分片的长度一定是8字节的整数倍。</p>
</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329104925231.png" class="" title="This is image-20200329104925231.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329104948669.png" class="" title="This is image-20200329104948669.png image.">
<ul>
<li><p>生存时间(TTL)</p>
<p>最多可经过多少的路由器。TTL=1,表示这个数据包只能在本局域网中传送。</p>
</li>
<li><p>协议</p>
<p>指明数据包携带的数据是使用的何种协议。</p>
</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329105537070.png" class="" title="This is image-20200329105537070.png image.">
<ul>
<li><p>首部检验和</p>
<p>只检验数据报的首部，不包括数据部分。</p>
</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329105803578.png" class="" title="This is image-20200329105803578.png image.">
<ul>
<li>源地址</li>
<li>目的地址</li>
</ul>
<h2 id="1-5-IP层转发分组的流程"><a href="#1-5-IP层转发分组的流程" class="headerlink" title="1.5 IP层转发分组的流程"></a>1.5 IP层转发分组的流程</h2><img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329112013621.png" class="" title="This is image-20200329112013621.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329112038321.png" class="" title="This is image-20200329112038321.png image.">
<p>图4-17的路由表所使用的“直接”“其他”，在实际的路由表中是0.0.0.0</p>
<p><strong>特定主机路由：</strong>指明主机的路由。</p>
<p><strong>默认路由：</strong>适用主机连接的路由器较少的情况。若只连接一个路由器，则可以将其设为默认路由。</p>
<p><strong>分组转发算法：</strong></p>
<ol>
<li><p>根据数据包的目的IP地址，得出目的网络地址N。</p>
</li>
<li><p>若路由器与目的网络相连，则<strong>直接交付</strong>。否则执行3</p>
</li>
<li>若路由表中有目的地址为D的<strong>特定主机路由</strong>，则传递给指定的路由。否则执行4</li>
<li>若<strong>本机路由表</strong>中有到达网络N的路由，则将数据包传递给所指明的吓一跳路由器。否则执行5</li>
<li>若路由表中有<strong>默认路由</strong>，则将数据包传递给默认路由。否则，报告转发分组出错。</li>
</ol>
<h1 id="2-划分子网"><a href="#2-划分子网" class="headerlink" title="2.划分子网"></a>2.划分子网</h1><p>​    将一个物理网络划分成多个子网，这些子网对外仍然表现为一个网络。</p>
<p>​    划分方法是：从主机号借用若干位作为子网号。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329134901908.png" class="" title="This is image-20200329134901908.png image.">
<p>​    当一个物理网络受到数据包后，再转发到具体的子网。具体的子网地址是通过IP地址与子网掩码相与取得的。路由器不光记录目的网络地址，还有目的网络地址的子网掩码。路由器将收到的数据包中的目的ip地址与子网掩码相与，然后与对应的网络地址相比较，相同则转发给该目的网络地址对应的接口。</p>
<p>​    五分类域间路由选择CIDR可以使用全0或全1的子网号，但有的路由器所用的路由选择软件不支持，所以慎用。</p>
<p><strong>使用子网时分组的转发：</strong><br>    路由表项包括：目的网络地址、子网掩码、下一跳地址。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329141745301.png" class="" title="This is image-20200329141745301.png image.">
<p>主机H1向目的主机H2发送数据包：</p>
<ol>
<li>取出目的ip地址128.30.33.138</li>
<li>判断是否和直接交付。将目的ip与本网络子网掩码255.255.255.128相与，得128.30.33.128，不是本网主机。则转发给路由R1。</li>
<li>R1查询目的地址与每个表项子网掩码相与，然后与其对应的目的网络地址比对，一致就转发给对应的接口。</li>
</ol>
<p>当发现目的地址不是本网的主机ip时，先找特定主机路由，没有特定主机路由的话找默认路由。</p>
<h1 id="3-无分类编址CIDR（构造超网）"><a href="#3-无分类编址CIDR（构造超网）" class="headerlink" title="3. 无分类编址CIDR（构造超网）"></a>3. 无分类编址CIDR（构造超网）</h1><p>​    CIDR消除了传统的A类、B类、C类地址以及划分子网的概念。    </p>
<p>地址表示：</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329151848450.png" class="" title="This is image-20200329151848450.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329152023454.png" class="" title="This is image-20200329152023454.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329152040363.png" class="" title="This is image-20200329152040363.png image.">
<p>​    全0，全1的地址一般不使用。他包含2^12^个地址。        </p>
<p>​    路由表项由“网络前缀”和“下一跳地址”组成。当匹配结果不止一个时，应从匹配结果中选择具有最长网络前缀的路由，这叫最长网络匹配。</p>
<h1 id="4-网际控制报文协议ICMP"><a href="#4-网际控制报文协议ICMP" class="headerlink" title="4. 网际控制报文协议ICMP"></a>4. 网际控制报文协议ICMP</h1><img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329155037499.png" class="" title="This is image-20200329155037499.png image.">
<p><strong>时间超过</strong>：当路由器接收到生存时间为0的数据包时，或者终点在预先的时间内未能收到一个数据包的全部报片时，发送时间超过报文。</p>
<p><strong>参数问题</strong>：数据包首部字段值不正确时，发送参数问题报文。</p>
<p><strong>改变路由</strong>（重定向）：当主机发送数据包时，首先查找自己的路由表。主机不和路由器交换路由信息。主机开始工作时，一般都会在路由表中设置一个默认路由器的IP地址。主机发送到其他网络的数据包都发送给默认路由。由于默认路由会和其他路由定期交换路由表信息，所以它知道到目的地址最佳的路由。如果默认路由发现主机发往某个目的地址的数据包的最佳路由应当经过网络上的另一个路由R时，就用改变路由报文把这情况告诉主机。主机就在路由表中添加一个项目：到某某目的地址的应该经过路由器R，而不是默认路由。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329161204654.png" class="" title="This is image-20200329161204654.png image.">
<p><strong>ICMP的前8个字节：</strong>依次包括前4字节(类型、代码、检验和)、ICMP类型有关的后4个字节。</p>
<p><strong>IP数据包数据字段的前8个字节</strong>：包含了运输层的端口号（对于TCP，UDP），以及运输层报文的发送序号。</p>
<p><strong>不发送ICMP差错报告报文的情况</strong>：</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329161716149.png" class="" title="This is image-20200329161716149.png image.">
<hr>
<p>ICMP询问报文：</p>
<ul>
<li>回送请求和回答。某个路由器或主机发送回送请求报文，接收到的主机回送回答报文。主要用来测试目的站是否可达。</li>
<li>时间戳请求和回答。</li>
</ul>
<h1 id="5-路由器选择协议"><a href="#5-路由器选择协议" class="headerlink" title="5. 路由器选择协议"></a>5. 路由器选择协议</h1><p>​    互联网中一个大的ISP就是一个自治系统AS。自治系统内使用同一个路由选择协议。对外表现出一个单一的和一致的路由选择策略。</p>
<p>分为两类：</p>
<ul>
<li><p>内部网关协议IGP(Interior Gateway Protocol)</p>
<p>一个自治系统内部使用的路由选择协议，与其他自治系统选择什么路由协议无关。如RIP和OSPF。</p>
</li>
<li><p>外部网关协议EGP(External Gateway Protocol)</p>
<p>他是自治系统之间如何路由的协议。如BGP-4。</p>
</li>
</ul>
<p>​    自治系统之间的路由选择也叫域间路由选择，自治系统内部的路由选择叫与域内路由选择。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329211122765.png" class="" title="This is image-20200329211122765.png image.">
<h2 id="5-1-内部网关协议RIP"><a href="#5-1-内部网关协议RIP" class="headerlink" title="5.1 内部网关协议RIP"></a>5.1 内部网关协议RIP</h2><p>​    RIP中一跳路径最多只能包含15个路由器，距离等于16则为不可达。可见RIP只适用于小型互联网。</p>
<p>​    <strong>RIP只选择一条最少路由器的路径</strong>，尽管该路径时延较高。<strong>即每一个路由到每一个网络的路由都是最短的。</strong></p>
<p>RIP协议特点：</p>
<ul>
<li>仅和相邻路由器交换信息。</li>
<li>相邻路由器之间交换当前本路由器所知道的全部信息，即自己现在的路由表。</li>
<li>按固定的时间间隔交换陆游信息，如每个30秒。</li>
</ul>
<p><strong>距离向量算法：</strong></p>
<ol>
<li><p>将地址为X的相邻路由器发来的RIP报文，先修改报文中所有项目：下一跳地址改为X；所有距离字段值加1。</p>
</li>
<li><p>对修改后的每一个表项，</p>
<p>若原来路由表中没有目的网络N，则把该项目添加到路由表中。</p>
<p>否则（本路由表中有目的网络N），若下一跳路由器地址为X，则替换原路由表中的项目。</p>
<p>否则（到目的网络N，但下一跳路由器不是X），若收到的项目中距离d更小，则进行更新。</p>
<p>否则什么也不做。</p>
</li>
<li><p>对于3分钟没有收到相邻路由器的更新路由表，则把距离置为16表示不可达。</p>
</li>
</ol>
<p><strong>例：</strong>路由器R6收到R4发来的更新信息：</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329224245531.png" class="" title="This is image-20200329224245531.png image.">
<p>解：</p>
<p>更新接收到的路由信息：</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329224441858.png" class="" title="This is image-20200329224441858.png image.">
<p>第一行R6没有，则直接添加。</p>
<p>第二行从R4出发，到达Net2的距离增大了，要更新。</p>
<p>第三行从R4出发，到达Net3的距离减小了，要更新。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200329224700915.png" class="" title="This is image-20200329224700915.png image.">
<p><strong>RIP协议报文格式：</strong></p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330024027164.png" class="" title="This is image-20200330024027164.png image.">
<p>​    RIP使用UDP进行传送，使用UDP的520端口。最大长度为4+20$\times$25=504字节。    </p>
<p><strong>命令</strong>：1表示请求路由信息；2表示对请求路由信息的响应，或未被请求而发出的路由更新报文。</p>
<p><strong>必为0</strong>：为了4字节对齐，而做的填充。</p>
<p><strong>地址族标识符(地址类别)</strong>：IP地址该字段为2，RIP考虑了其他非TCP/IP协议的情况。</p>
<p><strong>路由标记</strong>：为当前自治系统号ASN(Autonomous System Number)，以区别其他自治系统的路由信息。</p>
<p><strong>RIP2的鉴别功能：</strong><br>    第一个路由信息(20字节)用作鉴别。地址族标识符置为全1，路由标记写入鉴别类型，剩下16字节为鉴别数据。鉴别数据之后死路由信息，最多还能放24个路由信息。</p>
<p><strong>RIP的缺点：</strong><br>    当网1出现故障，R1可能在30秒后猜想R2发送更新消息。在这个时间段内，R1收到R2的更新消息，误认为到达网1可以经过R2。R2收到R1的更新消息，将自己到达网1的距离加1.循环往复至R1，R2到达网1的距离都是16，才能最终确定网1不可达。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330025905717.png" class="" title="This is image-20200330025905717.png image.">
<p>​    对于发现了一个更短的路由，这种更新消息就传播的快。</p>
<h2 id="5-2-内部网关协议OSPF"><a href="#5-2-内部网关协议OSPF" class="headerlink" title="5.2 内部网关协议OSPF"></a>5.2 内部网关协议OSPF</h2><ol>
<li>向本自治系统的<strong>所有路由器</strong>发送消息(洪泛法)，接收到消息的路由器不再向发送消息的路由器发送消息。</li>
<li>发送的消息就是本路由器与哪些路由器相邻，以及该链路的度量(如费用、距离、时延、带宽等)</li>
<li>当链路状态发生变化时，路由器才向所有路由器洪泛消息。</li>
</ol>
<p>​    最终所有路由器都能建立一个链路状态数据库(全网的拓扑结构图)，每个路由器根据该数据库，使用Dijkstra的最短路径路由算法构造自己的路由表。</p>
<p>​    优点是：更新过程收敛的快。</p>
<p><strong>基本原理：</strong></p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330033157293.png" class="" title="This is image-20200330033157293.png image.">
<p>​    每个区域的路由器只洪泛到本区域的路由器。</p>
<p><strong>OSPF报文格式：</strong></p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330033442224.png" class="" title="This is image-20200330033442224.png image.">
<p><strong>版本</strong>：当前版本号为2</p>
<p><strong>类型</strong>：五种类型分组的一种</p>
<p><strong>分组长度</strong>：OSPF分组的长度(包括OSPF首部)</p>
<p><strong>路由器标识符</strong>：标志发送该分组的路由器的接口的IP地址</p>
<p><strong>区域标识符</strong>：分组属于的区域标识符</p>
<p><strong>检验和</strong>：检验分组差错</p>
<p><strong>鉴别类型</strong>：0表示不用鉴别，1表示需要口令</p>
<p><strong>鉴别</strong>：鉴别类型为0时就填入0，鉴别类型为1就填入8个字符的口令。</p>
<p><strong>OSPF的特点：</strong></p>
<ul>
<li>可指派链路代价</li>
<li>对于代价相同的多条路径，可将通信量分配给这几条路径(<strong>多路径间的负载平衡</strong>)</li>
<li>可<strong>鉴别</strong>可信赖的路由器，交换只与可信赖路由器交换信息。</li>
<li>支持可变长度的子网划分和无分类编址CIDR</li>
<li>每个链路状态都有一个32位序号，序号越大状态越新。序号增长不超过5s/次。全部序号空间在600年内不会产生重复号。</li>
</ul>
<p><strong>OSPF的五种分组类型：</strong></p>
<ul>
<li>问候分组，用来发现和维持邻站的可达性。没10s交换一次，40s收不到则标记不可达。</li>
<li>数据库描述分组，向邻站发送自己的链路状态数据库中所有的链路状态项目的摘要信息</li>
<li>链路状态请求分组，向对方请求发送某些链路状态项目的详细信息</li>
<li>链路状态更新分组，洪泛法将本路由的链路状态通知给邻站</li>
<li>链路状态确认分组，对链路更新分组的确认</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330035650478.png" class="" title="This is image-20200330035650478.png image.">
<h1 id="5-3-外部网关协议-BGP"><a href="#5-3-外部网关协议-BGP" class="headerlink" title="5.3 外部网关协议 BGP"></a>5.3 外部网关协议 BGP</h1><p>特点：</p>
<ul>
<li><p>互联网规模太大，使得自治系统AS之间路由选择非常困难</p>
</li>
<li><p>自治系统AS之间的路由选择必须考虑有关策略</p>
<p>经过某些AS需要收费，或者保证国内的数据包不经过国外等</p>
<p>BGP并非要找到一条最佳路由。</p>
</li>
<li><p><strong>支持五分类域间路由选择CIDR。BGP的路由表包括：目的网络前缀、下一跳路由器、到达该目的网络所要经过的自治系统序列。</strong></p>
</li>
<li><p>BGP刚运行时，BGP路由交换整个BGP路由表。以后只更新有变化的部分。</p>
</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330082531492.png" class="" title="This is image-20200330082531492.png image.">
<p>​    BGP发言人建立TCP连接，来交换BGP报文(到达某个网络(使用网络前缀表示)，需要经过的一系列的自治系统)。<strong>BGP发言人除了运行内部网关协议，还要运行BGP协议</strong>。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330083145161.png" class="" title="This is image-20200330083145161.png image.">
<p>​    <strong>自治系统连通图是一种树形结构，不存在回路</strong>。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330084825270.png" class="" title="This is image-20200330084825270.png image.">
<p><strong>BGP-4报文：</strong></p>
<ul>
<li>OPEN报文，用来与相邻BGP发言人建立关系，使通信初始化</li>
<li>UPDATE报文，用来通告某一路由的信息，以及列出要撤销的多条路由</li>
<li>KEEPALIVE报文，用来周期性地证实邻站的连通性</li>
<li>NOTIFICATION报文，用来发送检测到的差错</li>
</ul>
<p><strong>两个不同AS的路由BGP的工作过程：</strong></p>
<ol>
<li>A站发送OPEN报文，B站用KEEPALIVE报文响应，建立邻站关系。</li>
<li>双方周期性(一般30秒)地交换KEEPALIVE报文(只有BGP报文的通用首部)。</li>
<li>使用IPDATE报文撤销(可以多条)它以前通知过的路由，或宣布增加(只有一条)新路由。</li>
</ol>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330085832266.png" class="" title="This is image-20200330085832266.png image.">
<p><strong>通用首部：</strong></p>
<p>标记：用来鉴别收到的BGP报文。不使用鉴别时标记字段为全1.</p>
<p>长度：包括首部在内的整个 BGP报文的长度，单位为字节，最小值为19，最大值为4096.</p>
<p>类型：1到4，标记四种BGP报文的一种。</p>
<p><strong>OPEN报文：</strong></p>
<p>版本：1字节，值为4,</p>
<p>本自治系统号：2字节</p>
<p>保持时间：2字节，以秒计算的保持为邻站关系的时间</p>
<p>BGP标识符：4字节，通常为该路由器的IP地址</p>
<p>可选参数长度：1字节</p>
<p>可选参数：</p>
<p><strong>UPDATE报文：</strong></p>
<p>不可行路由长度：2字节，撤销的路由的长度</p>
<p>撤销的路由：</p>
<p>路径属性总长度：2字节，路径属性的长度</p>
<p>路径属性：增加的路径的属性</p>
<p>网络层可达性信息：网络前缀的位数，IP地址前缀</p>
<p><strong>KEEPALIVE报文：</strong></p>
<p>BGP 19字节的通用首部。</p>
<p><strong>NOTIFICATION报文：</strong></p>
<p>差错代码：1字节</p>
<p>差错自带吗：1字节</p>
<p>差错数据：有关差错的诊断信息</p>
<h2 id="5-4-路由器的构成"><a href="#5-4-路由器的构成" class="headerlink" title="5.4 路由器的构成"></a>5.4 路由器的构成</h2><img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330092213972.png" class="" title="This is image-20200330092213972.png image.">
<p>​    输入端口和输出端口的123，分别代表物理层、数据链路层、网络层的处理模块。</p>
<p>​    转发表通常会在每一个输入端口中，路由选择处理机负责对各转发表的副本(影子副本)进行更新。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330093329036.png" class="" title="This is image-20200330093329036.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330093337437.png" class="" title="This is image-20200330093337437.png image.">
<p>交换结构：把一个分组从一个输入端口移到某个合适的输出端口。实现方法如下图。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330094708182.png" class="" title="This is image-20200330094708182.png image.">
<h1 id="6-IPv6"><a href="#6-IPv6" class="headerlink" title="6. IPv6"></a>6. IPv6</h1><ul>
<li>首部长度固定。</li>
<li>支持即插即用（即自动配置）。因此不需要DHCP</li>
<li>支持单播、多播、任播(anycast IPv6中的新类型，任播的终点是一组计算机，但数据包只交付其中一个，通常是距离最近的一个)</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330095343196.png" class="" title="This is image-20200330095343196.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330095451044.png" class="" title="This is image-20200330095451044.png image.">
<p><strong>版本</strong>：占4位，指明协议的版本，IPv6该字段为6</p>
<p><strong>通信量类</strong>：占8位，用于区分IPv6数据报的类别或优先级</p>
<p><strong>流标号</strong>：占20位，将数据报与给定的资源分配相联系。<strong>流就是互联网络上从特定源点到特定终点(单播或多播)的一系列数据报(如实时音频或视频传输)，而在这个“流”所经过的路径上的路由器都保证指明的服务质量。</strong>所有属于同一个流的数据报具有相同的流标号。然而对电子邮件或非实时数据，流标号无用，置为0.</p>
<p><strong>有效载荷长度</strong>：占16位，最大为64KB</p>
<p><strong>下一个首部</strong>：占8位，当IPv6数据报没有扩展首部时，下一个首部字段指出有效载荷部分应交付IP层上面的哪个高层协议。如6表示TCP，17表示UDP；当出现扩展首部时，下一个首部字段值标识后面第一个扩展首部的类型。</p>
<p><strong>调数限制</strong>：占8位，同IPv4的TTl。</p>
<p><strong>六种扩展首部：</strong></p>
<ul>
<li>逐跳选项(途径的路由器只理睬这种扩展首部，其他不会处理)</li>
<li>路由选择</li>
<li>分片</li>
<li>鉴别</li>
<li>封装安全有效载荷</li>
<li>目的站选项</li>
</ul>
<p><strong>冒号十六进制记法：</strong></p>
<ul>
<li><p>允许省略前面的0</p>
<p>如68E6:8C64:FFFF:FFFF:<strong>0</strong>:1180:960A:FFFF</p>
</li>
<li><p>零压缩（一个地址中只能使用一次零压缩）。</p>
<p>FF05:0:0:0:0:0:0:B3 可压缩为 FF05:B3</p>
<p>0:0:0:0:0:0:128.10.2.1 可压缩为 ::128.10.2.1</p>
</li>
<li><p>允许CIDR的斜线表示法。</p>
<p>12AB00000000CD3可记为12AB:0000:0000:CD30:0000:0000:0000:0000/60</p>
<p>或12AB::CD30:0:0:0:0/60</p>
<p>或12AB:0:0:CD30::/60</p>
</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330131305735.png" class="" title="This is image-20200330131305735.png image.">
<p>未指明地址和环回地址只有一个。</p>
<p>本地链路单播地址：有些单位的网络使用TCP/IP但并没有连接到互联网上。只能用于本网络内的通信。</p>
<p>全球单播地址：</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330132141029.png" class="" title="This is image-20200330132141029.png image.">
<p><strong>从IPv4向IPv6过渡：</strong></p>
<ol>
<li><p>双协议栈</p>
<p>一个主机同时运行IPv4协议和IPv6协议。具体使用哪种协议取决于DNS解析出来的是IPv4还是IPv6。</p>
</li>
</ol>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330132900804.png" class="" title="This is image-20200330132900804.png image.">
<ol>
<li>隧道技术</li>
</ol>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330133533151.png" class="" title="This is image-20200330133533151.png image.">
<h1 id="7-IP多播"><a href="#7-IP多播" class="headerlink" title="7. IP多播"></a>7. IP多播</h1><p>​    发送站只需要发送一次多播数据报，路由器在转发时要复制成多个副本转发，局域网具有硬件多播功能，不需要复制分组。</p>
<p>​    能够运行多播协议的路由器称为多播路由器。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200330140559116.png" class="" title="This is image-20200330140559116.png image.">
<p>​    多播数据报中写入的是多播地址，每个多播地址标志一个多播组。</p>
<p>​    多播数据报是尽最大努力的交付，不保证一定能够交付多播组内的所有成员。</p>
<p>​    多播数据报与单播数据报的区别是：多播地址使用D类地址作为目的地址，首部的协议字段值为2，表明使用网际组管理协议IGMP。</p>
<p>​    多播地址只能用于目的地址，不能用于源地址。</p>
<p>​    多播数据报不产生ICMP差错报文。</p>
<h2 id="7-1-局域网中的硬件多播"><a href="#7-1-局域网中的硬件多播" class="headerlink" title="7.1 局域网中的硬件多播"></a>7.1 局域网中的硬件多播</h2><ul>
<li>硬件地址第一个字节的最低位为1，表示多播地址</li>
<li>硬件多播地址的范围是01-00-5E-00-00-00到01-00-5E-7E-FF-FF</li>
<li>取多播IP地址的后23位添加到MAC地址中，如下图</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331095216937.png" class="" title="This is image-20200331095216937.png image.">
<p>​    但IP多播地址224.128.64.32（E0-80-40-20）与224.0.64.32（E0-00-40-20）转换后的硬件多播地址都为01-00-5E-00-40-20，所以多播IP地址与硬件地址的映射是不唯一的，因此主机利用软件判别多播数据报是否是本机需要的。</p>
<h3 id="7-1-1-网际组管理协议IGMP"><a href="#7-1-1-网际组管理协议IGMP" class="headerlink" title="7.1.1 网际组管理协议IGMP"></a>7.1.1 网际组管理协议IGMP</h3><p><strong>IGMP协议是让连接在本地局域网上的多播路由器知道本局域网上是否有主机参加或退出了某个多播组。</strong></p>
<p>第一阶段：当某台主机加入新的多播组时，该主机向多播组的多播地址发送一个IGMP报文，声明自己要称为该组成员。本地多播路由器收到IGMP报文后，利用多播路由选择协议把这种组成员关系转发给互联网上的其他多播路由器。</p>
<p>第二阶段：<strong>本地多播路由器</strong>周期性探询本地局域网上的主机，<strong>只要有一个主机</strong>对<strong>某个组</strong>响应，多播路由器就将这个组的成员关系转发给其他多播路由器，否则不发送。</p>
<ul>
<li>IGMP使用IP数据报传递。</li>
<li>主机和本地多播路由器之间的所有通信都是使用IP多播。没有参加IP多播的主机不会受到IGMP报文。</li>
<li>本地多播路由器对<strong>所有组</strong>发送一个请求信息的询问报文，而不是对每一个组。</li>
<li>当存在多个本地多播路由器时，<strong>只有一个</strong>本地多播路由器探询主机的成员关系。</li>
<li><strong>同一个组</strong>只要有一个主机发送了响应，<strong>本组其他主机</strong>就不用再发送响应。</li>
<li>某台主机的多个进程属于同一个多播组，每个多播数据报只接收一个副本，然后给多个进程发送本地复制的副本。</li>
</ul>
<h3 id="7-1-2-多播路由选择协议"><a href="#7-1-2-多播路由选择协议" class="headerlink" title="7.1.2 多播路由选择协议"></a>7.1.2 多播路由选择协议</h3><h4 id="7-1-2-1-洪泛与剪除："><a href="#7-1-2-1-洪泛与剪除：" class="headerlink" title="7.1.2.1 洪泛与剪除："></a>7.1.2.1 洪泛与剪除：</h4><p>​    适用于较小的多播组，所有组成员接入的局域网也是相邻接的。</p>
<p><strong>反向路径传播策略：</strong></p>
<ul>
<li>对每个多播数据包，检查是否是从源点经最短路径传送来的。</li>
<li>若存在多条最短路径，选择IP地址最小的那条路径。</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331110742055.png" class="" title="This is image-20200331110742055.png image.">
<p><strong>剪除：</strong>下游没有多播组的成员就剪枝；添加新的组成员时，再接入到多播转发树上。</p>
<h4 id="7-1-2-2-隧道技术"><a href="#7-1-2-2-隧道技术" class="headerlink" title="7.1.2.2 隧道技术"></a>7.1.2.2 隧道技术</h4><p>​    适用于多播组的位置在地理上很分散的情况。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331111134939.png" class="" title="This is image-20200331111134939.png image.">
<h4 id="7-1-2-3-基于核心的发现技术"><a href="#7-1-2-3-基于核心的发现技术" class="headerlink" title="7.1.2.3 基于核心的发现技术"></a>7.1.2.3 基于核心的发现技术</h4><p>​    对每一个多播组G制定一个<strong>核心路由器</strong>，并给出他的IP单播地址。</p>
<p>​    按照洪泛与剪枝的方法构造多播组G的转发树。</p>
<p>若：路由器R1向核心路由器发送数据报，途径的每个路由器都会检查其内容。当数据报到达参加了多播组G的路由器R2时，R2处理这个数据包。</p>
<p>若：R1发送一个目的地址是G的组地址的多播数据包，R2就向多播组的成员转发这个多播数据报。</p>
<p>若：R1发出的是请求加入多播组G的数据包，R2将这个信息加入本路由中，并用隧道技术向R1转发每一个多播数据包的一个副本。</p>
<h1 id="8-虚拟专用网VPN"><a href="#8-虚拟专用网VPN" class="headerlink" title="8. 虚拟专用网VPN"></a>8. 虚拟专用网VPN</h1><p><strong>专用地址：</strong>用作仅在本内部通信的地址。</p>
<ul>
<li><p>10.0.0.0 到 10.255.255.255 （即10.0.0.0/8）</p>
</li>
<li><p>172.16.0.0 到 172.31.255.255 （即172.16.0.0/12）</p>
</li>
<li><p>192.168.0.0 到 192.168.255.255 （即192.168.0.0/16）</p>
<p><strong>互联网中所有的路由器对目的地址是专用地址的数据包一律不转发。</strong></p>
<p>多个专用网之间的通信，若要经过公网，则所有通过互联网传送的数据都必须加密。</p>
</li>
</ul>
<p><strong>基本原理：</strong></p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331155332987.png" class="" title="This is image-20200331155332987.png image.">
<p><strong>内联网VPN</strong>：所有的内部网络都同属一个机构。</p>
<p><strong>外联网VPN</strong>：内部网络中有其他机构。</p>
<p><strong>远程接入VPN</strong>：个人在外地连接内部网络。</p>
<h2 id="8-1-网络地址转换NAT（内部主机访问外网）"><a href="#8-1-网络地址转换NAT（内部主机访问外网）" class="headerlink" title="8.1 网络地址转换NAT（内部主机访问外网）"></a>8.1 网络地址转换NAT（内部主机访问外网）</h2><h3 id="8-1-1-NAT"><a href="#8-1-1-NAT" class="headerlink" title="8.1.1 NAT"></a>8.1.1 NAT</h3><p>​    NAT是不能节约公网IP地址的。使用NAT需要在路由器上安装NAT软件，称为<strong>NAT路由器</strong>。NAT路由器根据内网IP与公网IP的映射表来进行地址转换。NAT路由器有多少个公网IP，内网就可以<strong>同时</strong>允许多少台电脑上网。当然，内网主机可以轮流使用NAT路由器中的公网IP，先到先得。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331160608238.png" class="" title="This is image-20200331160608238.png image.">
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331160626301.png" class="" title="This is image-20200331160626301.png image.">
<h3 id="8-1-2-NAPT"><a href="#8-1-2-NAPT" class="headerlink" title="8.1.2 NAPT"></a>8.1.2 NAPT</h3><p>​    节约公网IP地址。<strong>一般</strong>将内网IP地址映射为一个公网IP地址，通过运输层的端口号来区别是哪个主机。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331161352699.png" class="" title="This is image-20200331161352699.png image.">
<h1 id="9-多协议标记交换MPLS"><a href="#9-多协议标记交换MPLS" class="headerlink" title="9. 多协议标记交换MPLS"></a>9. 多协议标记交换MPLS</h1><p>特点：</p>
<ul>
<li>支持面向连接的服务质量</li>
<li>支持流量工程，平衡网络负载</li>
<li>有效地支持虚拟专用网VPN</li>
<li>基于<strong>显示路由选择</strong>确定转发路径</li>
<li>MPLS根据标记在数据链路层用硬件进行<strong>转发</strong>(在标记交换路由器中进行标记对换)，转发速率大大加快。</li>
</ul>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331162815969.png" class="" title="This is image-20200331162815969.png image.">
<p><strong>MPLS域</strong>：域中有许多彼此相邻的路由器，并且所有的路由器都是支持MPLS技术的<strong>标记交换路由器LSR</strong>(用于转发和标记对换)。</p>
<p><strong>标记交换路径LSP</strong>：个LSR使用专门的<strong>标记分配协议LDP</strong>交换报文，并找出和特定标记相对应路径。各LSR根据这些路径构造转发表。</p>
<p><strong>根据标记查找出口</strong>：</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331163344513.png" class="" title="This is image-20200331163344513.png image.">
<p><strong>标记对换</strong>：将数据报的入标记转化为出标记。</p>
<p><strong>显示路由选择</strong>：由入口LSR确定进入MPLS域后的转发路径。</p>
<font size=5, color="#ff0000">转发等价类FEC：</font>

<p>作用是对于满足某种条件的IP数据包采用特定的转发策略。条件的选取有网络管理员来控制，非常灵活。</p>
<p>例如：H1，H2分别向H3，H4发送数据。传统路由选择协议只能选择最短路径A$\rightarrow$B$\rightarrow$C。采用MPLS可设置FEC来实现负载平衡。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331170049248.png" class="" title="This is image-20200331170049248.png image.">
<p>可设置两种FEC：源地址为H1而目的地址为H3、源地址为H2而目的地址为H4。把前一种路径设置为H1$\rightarrow$A$\rightarrow$BC$\rightarrow$H3，后一种路径设置为H2$\rightarrow$A$\rightarrow$D$\rightarrow$E$\rightarrow$C$\rightarrow$H4。这种均衡网络负载的做法也称为<strong>流量工程TE</strong>或<strong>通信量工程</strong>。</p>
<img src="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/image-20200331170826780.png" class="" title="This is image-20200331170826780.png image.">
<p>生存时间TTL：防止MPLS分组在MPLS域中兜圈子。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://jeckfs.gitee.io/JeckFS">YFS</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://jeckfs.gitee.io/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/">http://jeckfs.gitee.io/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%B1%82/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://jeckfs.gitee.io/JeckFS" target="_blank">JeckFS</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/JeckFS/tags/%E7%BD%91%E7%BB%9C/">网络</a></div><div class="post_share"><div class="social-share" data-image="https://img1.baidu.com/it/u=2598981474,2305186611&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=800&amp;h=500" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/gh/overtrue/share.js@master/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/JeckFS/2020/07/28/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E8%BF%90%E8%BE%93%E5%B1%82/"><img class="prev-cover" src="https://img1.baidu.com/it/u=2860717797,2343059675&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=889&amp;h=500" onerror="onerror=null;src='/JeckFS/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">计算机网络-谢希任-运输层</div></div></a></div><div class="next-post pull-right"><a href="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/"><img class="next-cover" src="https://img2.baidu.com/it/u=341242123,757592285&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1280&amp;h=800" onerror="onerror=null;src='/JeckFS/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">计算机网络-谢希任-数据链路层</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%81-%E7%89%A9%E7%90%86%E5%B1%82/" title="计算机网络-谢希仁-物理层"><img class="cover" src="https://img2.baidu.com/it/u=1787475710,2159333383&fm=253&fmt=auto&app=120&f=JPEG?w=1280&h=800" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-27</div><div class="title">计算机网络-谢希仁-物理层</div></div></a></div><div><a href="/JeckFS/2020/07/29/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/" title="计算机网络-谢希任-网络安全"><img class="cover" src="https://img1.baidu.com/it/u=2709423071,2700494803&fm=253&fmt=auto&app=120&f=JPEG?w=500&h=281" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-29</div><div class="title">计算机网络-谢希任-网络安全</div></div></a></div><div><a href="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E6%A6%82%E8%BF%B0/" title="计算机网络-谢希任-概述"><img class="cover" src="https://img0.baidu.com/it/u=3798217922,3880088897&fm=253&fmt=auto&app=120&f=JPEG?w=889&h=500" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-27</div><div class="title">计算机网络-谢希任-概述</div></div></a></div><div><a href="/JeckFS/2020/07/27/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82/" title="计算机网络-谢希任-数据链路层"><img class="cover" src="https://img2.baidu.com/it/u=341242123,757592285&fm=253&fmt=auto&app=120&f=JPEG?w=1280&h=800" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-27</div><div class="title">计算机网络-谢希任-数据链路层</div></div></a></div><div><a href="/JeckFS/2020/07/28/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E8%B0%A2%E5%B8%8C%E4%BB%BB-%E8%BF%90%E8%BE%93%E5%B1%82/" title="计算机网络-谢希任-运输层"><img class="cover" src="https://img1.baidu.com/it/u=2860717797,2343059675&fm=253&fmt=auto&app=138&f=JPEG?w=889&h=500" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-28</div><div class="title">计算机网络-谢希任-运输层</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://i.loli.net/2021/02/24/5O1day2nriDzjSu.png" onerror="this.onerror=null;this.src='/JeckFS/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">YFS</div><div class="author-info__description">快乐每一天</div></div><div class="card-info-data site-data is-center"><a href="/JeckFS/archives/"><div class="headline">文章</div><div class="length-num">217</div></a><a href="/JeckFS/tags/"><div class="headline">标签</div><div class="length-num">62</div></a><a href="/JeckFS/categories/"><div class="headline">分类</div><div class="length-num">57</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E7%BD%91%E9%99%85%E5%8D%8F%E8%AE%AEIP"><span class="toc-number">1.</span> <span class="toc-text">1. 网际协议IP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%88%86%E7%B1%BB%E7%9A%84IP%E5%9C%B0%E5%9D%80"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 分类的IP地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-IP%E5%9C%B0%E5%9D%80%E5%92%8C%E7%A1%AC%E4%BB%B6%E5%9C%B0%E5%9D%80"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 IP地址和硬件地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AEARP"><span class="toc-number">1.3.</span> <span class="toc-text">1.3. 地址解析协议ARP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-IP%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E6%A0%BC%E5%BC%8F"><span class="toc-number">1.4.</span> <span class="toc-text">4. IP数据包的格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-5-IP%E5%B1%82%E8%BD%AC%E5%8F%91%E5%88%86%E7%BB%84%E7%9A%84%E6%B5%81%E7%A8%8B"><span class="toc-number">1.5.</span> <span class="toc-text">1.5 IP层转发分组的流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91"><span class="toc-number">2.</span> <span class="toc-text">2.划分子网</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E6%97%A0%E5%88%86%E7%B1%BB%E7%BC%96%E5%9D%80CIDR%EF%BC%88%E6%9E%84%E9%80%A0%E8%B6%85%E7%BD%91%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">3. 无分类编址CIDR（构造超网）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E7%BD%91%E9%99%85%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AEICMP"><span class="toc-number">4.</span> <span class="toc-text">4. 网际控制报文协议ICMP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E8%B7%AF%E7%94%B1%E5%99%A8%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="toc-number">5.</span> <span class="toc-text">5. 路由器选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AERIP"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 内部网关协议RIP</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEOSPF"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 内部网关协议OSPF</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-3-%E5%A4%96%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE-BGP"><span class="toc-number">6.</span> <span class="toc-text">5.3 外部网关协议 BGP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E6%9E%84%E6%88%90"><span class="toc-number">6.1.</span> <span class="toc-text">5.4 路由器的构成</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-IPv6"><span class="toc-number">7.</span> <span class="toc-text">6. IPv6</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-IP%E5%A4%9A%E6%92%AD"><span class="toc-number">8.</span> <span class="toc-text">7. IP多播</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B8%AD%E7%9A%84%E7%A1%AC%E4%BB%B6%E5%A4%9A%E6%92%AD"><span class="toc-number">8.1.</span> <span class="toc-text">7.1 局域网中的硬件多播</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-1-%E7%BD%91%E9%99%85%E7%BB%84%E7%AE%A1%E7%90%86%E5%8D%8F%E8%AE%AEIGMP"><span class="toc-number">8.1.1.</span> <span class="toc-text">7.1.1 网际组管理协议IGMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-2-%E5%A4%9A%E6%92%AD%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE"><span class="toc-number">8.1.2.</span> <span class="toc-text">7.1.2 多播路由选择协议</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-1-%E6%B4%AA%E6%B3%9B%E4%B8%8E%E5%89%AA%E9%99%A4%EF%BC%9A"><span class="toc-number">8.1.2.1.</span> <span class="toc-text">7.1.2.1 洪泛与剪除：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-2-%E9%9A%A7%E9%81%93%E6%8A%80%E6%9C%AF"><span class="toc-number">8.1.2.2.</span> <span class="toc-text">7.1.2.2 隧道技术</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-1-2-3-%E5%9F%BA%E4%BA%8E%E6%A0%B8%E5%BF%83%E7%9A%84%E5%8F%91%E7%8E%B0%E6%8A%80%E6%9C%AF"><span class="toc-number">8.1.2.3.</span> <span class="toc-text">7.1.2.3 基于核心的发现技术</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91VPN"><span class="toc-number">9.</span> <span class="toc-text">8. 虚拟专用网VPN</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2NAT%EF%BC%88%E5%86%85%E9%83%A8%E4%B8%BB%E6%9C%BA%E8%AE%BF%E9%97%AE%E5%A4%96%E7%BD%91%EF%BC%89"><span class="toc-number">9.1.</span> <span class="toc-text">8.1 网络地址转换NAT（内部主机访问外网）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-1-NAT"><span class="toc-number">9.1.1.</span> <span class="toc-text">8.1.1 NAT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-2-NAPT"><span class="toc-number">9.1.2.</span> <span class="toc-text">8.1.2 NAPT</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E5%A4%9A%E5%8D%8F%E8%AE%AE%E6%A0%87%E8%AE%B0%E4%BA%A4%E6%8D%A2MPLS"><span class="toc-number">10.</span> <span class="toc-text">9. 多协议标记交换MPLS</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/JeckFS/2022/07/10/JK-Redis-%E4%B8%BB%E4%BB%8E%E5%BA%93%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/" title="JK-Redis-主从库数据同步"><img src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/JeckFS/img/404.jpg'" alt="JK-Redis-主从库数据同步"/></a><div class="content"><a class="title" href="/JeckFS/2022/07/10/JK-Redis-%E4%B8%BB%E4%BB%8E%E5%BA%93%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5/" title="JK-Redis-主从库数据同步">JK-Redis-主从库数据同步</a><time datetime="2022-07-10T09:02:33.000Z" title="发表于 2022-07-10 17:02:33">2022-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JeckFS/2022/07/10/JK-Redis-%E5%86%85%E5%AD%98%E5%BF%AB%E7%85%A7/" title="JK-Redis-内存快照"><img src="https://img2.baidu.com/it/u=341242123,757592285&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1280&amp;h=800" onerror="this.onerror=null;this.src='/JeckFS/img/404.jpg'" alt="JK-Redis-内存快照"/></a><div class="content"><a class="title" href="/JeckFS/2022/07/10/JK-Redis-%E5%86%85%E5%AD%98%E5%BF%AB%E7%85%A7/" title="JK-Redis-内存快照">JK-Redis-内存快照</a><time datetime="2022-07-10T07:53:54.000Z" title="发表于 2022-07-10 15:53:54">2022-07-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JeckFS/2022/07/09/JK-Redis-AOF%E6%97%A5%E5%BF%97/" title="JK-Redis-AOF日志"><img src="https://img2.baidu.com/it/u=2566230917,2808117782&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=889&amp;h=500" onerror="this.onerror=null;this.src='/JeckFS/img/404.jpg'" alt="JK-Redis-AOF日志"/></a><div class="content"><a class="title" href="/JeckFS/2022/07/09/JK-Redis-AOF%E6%97%A5%E5%BF%97/" title="JK-Redis-AOF日志">JK-Redis-AOF日志</a><time datetime="2022-07-09T01:44:22.000Z" title="发表于 2022-07-09 09:44:22">2022-07-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JeckFS/2022/07/05/leetcode3-%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2/" title="leetcode3-无重复字符的最长子串"><img src="https://img2.baidu.com/it/u=341242123,757592285&amp;fm=253&amp;fmt=auto&amp;app=120&amp;f=JPEG?w=1280&amp;h=800" onerror="this.onerror=null;this.src='/JeckFS/img/404.jpg'" alt="leetcode3-无重复字符的最长子串"/></a><div class="content"><a class="title" href="/JeckFS/2022/07/05/leetcode3-%E6%97%A0%E9%87%8D%E5%A4%8D%E5%AD%97%E7%AC%A6%E7%9A%84%E6%9C%80%E9%95%BF%E5%AD%90%E4%B8%B2/" title="leetcode3-无重复字符的最长子串">leetcode3-无重复字符的最长子串</a><time datetime="2022-07-05T03:53:23.000Z" title="发表于 2022-07-05 11:53:23">2022-07-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/JeckFS/2022/07/01/Electron-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/" title="Electron-进程间通信"><img src="https://img1.baidu.com/it/u=2322041376,2548191196&amp;fm=253&amp;fmt=auto&amp;app=138&amp;f=JPEG?w=889&amp;h=500" onerror="this.onerror=null;this.src='/JeckFS/img/404.jpg'" alt="Electron-进程间通信"/></a><div class="content"><a class="title" href="/JeckFS/2022/07/01/Electron-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1/" title="Electron-进程间通信">Electron-进程间通信</a><time datetime="2022-07-01T11:00:34.000Z" title="发表于 2022-07-01 19:00:34">2022-07-01</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By YFS</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div><script src="/JeckFS/js/utils.js"></script><script src="/JeckFS/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="/JeckFS/js/search/local-search.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>